// /scripts/make-image-list.mjs
import fs from "fs";
import path from "path";

const IMAGES_DIR = path.join(process.cwd(), "public", "images");
const OUT_FILE = path.join(process.cwd(), "src", "app", "imageList.ts");

// read all image files in /public/images
const files = fs
  .readdirSync(IMAGES_DIR, { withFileTypes: true })
  .filter((d) => d.isFile())
  .map((d) => d.name)
  .filter((f) => /\.(jpe?g|png|webp)$/i.test(f))
  .filter((f) => !f.startsWith(".")) // ignore hidden files
  .sort();

// Heuristic: JPG/JPEG/WEBP = photos, PNG = plans/diagrams
const PHOTOS = files.filter((f) => /\.(jpe?g|webp)$/i.test(f));
const PLANS  = files.filter((f) => /\.png$/i.test(f));

const content = `// AUTO-GENERATED by scripts/make-image-list.mjs
export const PHOTOS: string[] = ${JSON.stringify(PHOTOS, null, 2)};
export const PLANS:  string[] = ${JSON.stringify(PLANS,  null, 2)};
export const ALL_IMAGES: string[] = ${JSON.stringify(files, null, 2)};
`;

fs.mkdirSync(path.dirname(OUT_FILE), { recursive: true });
fs.writeFileSync(OUT_FILE, content, "utf8");

console.log(`Wrote: ${OUT_FILE}`);
console.log(`Found ${PHOTOS.length} photos and ${PLANS.length} plans in /public/images`);
